<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<%- include("template/cabecera", {tituloWeb: 'Lista de Videojuegos'}) %>
    
    <div class="container mt-4 mb-4">
        <a class="btn btn-light" href="/juegos/crear">Añadir</a>
    </div>
    <div   class="container mb-4 mt-2 d-flex justify-content-center" style="align-items: center;">
        <div class="card bg-light bg-gradient border-primary" style="width:30rem;">
            <table style="text-align:center;" class="table align-middle mb-0 mx-0 px-0">
                <thead>
                <tr>
                    
                    <th scope="col">Juego</th>
                </tr>
                </thead>
                <tbody>
                    
                    <% if (arrayvideojuegos.length > 0) { %>
                        <% arrayvideojuegos.forEach(function(juego, key) { %>
                            
                            <tr>
                                <td>
                                        
                                    <tr>
                                        <th scope="row">
                                            <div class="d-inline"><%= juego.nombre %></div>
                                            <div class="d-inline px-3">
                                                <span class="fa fa-star"></span><%= juego.calificacion/20 %></div>
                                        </th>
                                    </tr>
                                    <tr>   
                                        <td>
                                            <div class="d-inline px-4"><%= juego.año %> </div>
                                            <div class="d-inline px-4" ><%= juego.genero %></div>
                                            <div class="d-inline px-4"><%= juego.plataformas %></div>
                                        </td>
                                    </tr>
                                    <tr><td><div class="px-5 mx-5"><%= juego.descripcion %></div></td></tr>
                                    <tr><td><a href="juegos/<%=juego.id%>" class="btn btn-warning btn-sm mx-5">Editar</a>
                                    <button
                                            class="btn btn-danger btn-sm"
                                            id="btnEliminar"
                                            data-id="<%= juego.id %>"
                                            >Eliminar
                                    </button></td></tr>

                                 </td>
                            </tr>
                        <% }); %>
                    <% } %>

                </tbody>
            </table>
        </div>
    </div>

<%- include("template/footer") %>
<script>
    const btns = document.querySelectorAll('#btnEliminar');
    console.log(btns);
    btns.forEach(function(btn, key) {
        btn.addEventListener('click', async()=>{
            console.log("click")
            const id = btn.dataset.id
            try {
                const data = await fetch(`/juegos/${id}`, {method:'delete'})
                const res = await data.json()
                if(res.estado){
                    window.location.href = '/juegos'
                } else{
                    console.log(res)
                }
            } catch (error) {
                console.log(error)
            }
        });

    });

    
</script>